# I want to experiment with a HYDRATED yaml (embedding project ids and such)
# just to see how it goes across multiple machines. I never do that, I just
# want to see the experience in my vanilla app.
#

apiVersion: skaffold/v3 # v2beta29
kind: Config
metadata:
  name: vanilla-app
# build:
#   artifacts:
#   - image:  vanilla-app
#     context: app
#     buildpacks:
#       builder: gcr.io/buildpacks/builder:v1
# common build for all
build:
  artifacts:
    # SKU stands for Skaffold + Kustomize
    - image: sku-vanilla-app-image
      context: app
      buildpacks:
        builder: gcr.io/buildpacks/builder:v1
# manifests:
#   kustomize:
#     paths: ["deploy/k8s/overlays/dev"]
# deploy:
#   cloudrun:
#     projectid: cicd-platinum-test032
#     region: us-central1
# no deploy without module..
# deploy:
#       kustomize:
#         paths: ["deploy/k8s/overlays/dev"]
    # Target platforms: [linux/amd64]
# deploy:
#   kubectl:
#     manifests:
#     #- app2/deployment.yaml
#     - deploy/k8s/*.yaml
profiles:
  - name: dev
    #kube-context: gke_cicd-platinum-test031_us-central1_cicd-dev
    manifests:
      kustomize:
        paths: ["deploy/k8s/overlays/dev"]

  - name: cloudrun-test
    deploy:
      cloudrun:
        projectid: cicd-platinum-test032
        region: us-central1

  # #kube-context:
  - name: prod
    #activation:
    #kubectl:
    deploy:
      kubeContext: 'gke_cicd-platinum-test031_us-central1_cicd-prod'
    manifests:
      kustomize:
        paths: ["deploy/k8s/overlays/prod"]
